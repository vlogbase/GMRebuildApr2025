<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Affiliate Tab</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        body {
            background-color: #121212;
            color: #e4e6eb;
        }
        .card {
            background-color: #1e1e1e;
            border-color: #333;
        }
        .card-header {
            background-color: #2c2f33;
            border-color: #333;
        }
        .form-control {
            background-color: #2c2f33;
            color: #e4e6eb;
            border-color: #3f4246;
        }
    </style>
</head>
<body>
    <div class="container mt-5">
        <h2 class="mb-4">Test: Tell a Friend Tab</h2>
        
        <div class="row">
            <div class="col-12">
                <!-- Include the simplified tab content directly -->
                <div id="tellFriend" class="tab-pane fade show active" role="tabpanel">
                    <!-- Tell a Friend Tab Content (Simplified Version) -->
                    <div class="row mb-4">
                        <div class="col-12">
                            <div class="card">
                                <div class="card-header">
                                    <h5 class="mb-0">Tell a Friend</h5>
                                </div>
                                <div class="card-body">
                                    <!-- Simplified version that always shows referral tools -->
                                    <div class="row mb-4">
                                        <div class="col-md-8 mb-4 mb-md-0">
                                            <div class="mb-4">
                                                <h5 class="mb-3">Your Referral Link</h5>
                                                <div style="display: flex; width: 100%; margin-bottom: 10px;">
                                                    <div class="form-control" id="referralLink" style="flex: 1; padding: 10px; background-color: #2c2f33; color: #e4e6eb; border-color: #3f4246; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; cursor: text;">https://gloriamundo.com?ref=TEST123</div>
                                                    <button class="btn btn-outline-primary" type="button" id="copyReferralLink" style="flex-shrink: 0; margin-left: 5px;">
                                                        <i class="fas fa-copy"></i> Copy
                                                    </button>
                                                </div>
                                                <p class="form-text mt-2">Share this link to earn commissions on your friends' purchases.</p>
                                            </div>
                                            
                                            <div class="alert alert-info mb-4">
                                                <div class="d-flex">
                                                    <div class="me-3">
                                                        <i class="fas fa-lightbulb fa-2x text-warning"></i>
                                                    </div>
                                                    <div>
                                                        <h5 class="alert-heading">Quick Tip</h5>
                                                        <p class="mb-0">Want to share a specific page or chat? Just add <code>?ref=TEST123</code> to the end of any GloriaMundo URL!</p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="col-md-4">
                                            <!-- QR Code for Mobile Sharing -->
                                            <div class="card h-100 border-primary">
                                                <div class="card-header bg-primary text-white">
                                                    <h5 class="mb-0">Share via QR Code</h5>
                                                </div>
                                                <div class="card-body text-center">
                                                    <img src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://gloriamundo.com?ref=TEST123" 
                                                         alt="Your Referral QR Code" class="img-fluid mb-2"
                                                         style="max-width: 100%; height: auto;">
                                                    <p class="mb-0 small">Scan with a smartphone camera to quickly share your link</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="row mb-4">
                                        <div class="col-12">
                                            <h5 class="mb-3">Commission Summary</h5>
                                            <div class="row text-center">
                                                <div class="col-md-4 mb-3">
                                                    <div class="card bg-dark h-100">
                                                        <div class="card-body">
                                                            <i class="fas fa-money-bill-wave fa-2x mb-3 text-success"></i>
                                                            <h2 class="text-light">$120.00</h2>
                                                            <p class="text-muted">Total Earned</p>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-4 mb-3">
                                                    <div class="card bg-dark h-100">
                                                        <div class="card-body">
                                                            <i class="fas fa-clock fa-2x mb-3 text-warning"></i>
                                                            <h2 class="text-light">$45.00</h2>
                                                            <p class="text-muted">Pending</p>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-4 mb-3">
                                                    <div class="card bg-dark h-100">
                                                        <div class="card-body">
                                                            <i class="fas fa-users fa-2x mb-3 text-info"></i>
                                                            <h2 class="text-light">5</h2>
                                                            <p class="text-muted">Referrals</p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Custom Script to test our simplified tab functionality -->
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        console.log('DOM fully loaded - testing affiliate tab functionality');
        
        // Define the simplified function to initialize tab content
        function initializeSimplifiedTellFriendTab() {
            console.log('Initializing NEW simplified Tell a Friend tab functions');
        
            // Copy referral link functionality
            const copyBtn = document.getElementById('copyReferralLink');
            const referralLinkInput = document.getElementById('referralLink');
            
            if (copyBtn && referralLinkInput) {
                copyBtn.addEventListener('click', function() {
                    // Get the text to copy
                    const textToCopy = referralLinkInput.textContent;
                    
                    // Use modern Clipboard API with fallback
                    if (navigator.clipboard && window.isSecureContext) {
                        navigator.clipboard.writeText(textToCopy)
                            .then(() => {
                                console.log('Text copied to clipboard successfully');
                                // Show feedback
                                const originalText = copyBtn.innerHTML;
                                copyBtn.innerHTML = '<i class="fas fa-check"></i> Copied!';
                                
                                // Reset button text after 2 seconds
                                setTimeout(() => {
                                    copyBtn.innerHTML = originalText;
                                }, 2000);
                            })
                            .catch(err => {
                                console.error('Error copying text: ', err);
                            });
                    } else {
                        // Fallback for older browsers
                        console.log('Using fallback clipboard method');
                        
                        // Create a temporary input element
                        const textArea = document.createElement('textarea');
                        textArea.value = textToCopy;
                        
                        // Make the textarea out of viewport
                        textArea.style.position = 'fixed';
                        textArea.style.left = '-999999px';
                        textArea.style.top = '-999999px';
                        document.body.appendChild(textArea);
                        
                        // Focus and select the text
                        textArea.focus();
                        textArea.select();
                        
                        // Copy the text
                        let success = false;
                        try {
                            success = document.execCommand('copy');
                        } catch (err) {
                            console.error('Failed to copy: ', err);
                        }
                        
                        // Remove the temporary element
                        document.body.removeChild(textArea);
                        
                        // Provide feedback
                        if (success) {
                            const originalText = copyBtn.innerHTML;
                            copyBtn.innerHTML = '<i class="fas fa-check"></i> Copied!';
                            
                            // Reset button text after 2 seconds
                            setTimeout(() => {
                                copyBtn.innerHTML = originalText;
                            }, 2000);
                        } else {
                            copyBtn.innerHTML = '<i class="fas fa-times"></i> Failed';
                            setTimeout(() => {
                                copyBtn.innerHTML = '<i class="fas fa-copy"></i> Copy';
                            }, 2000);
                        }
                    }
                });
            } else {
                console.warn('Copy button or link element not found');
            }
        }
        
        // Global functions for testing
        window.initializeTellFriendTabContentNew = function() {
            console.log('Tell a Friend tab activated, initializing NEW simplified content');
            initializeSimplifiedTellFriendTab();
        };
        
        // Override the original function
        window.initializeTellFriendTabContent = function() {
            console.log('Original initializeTellFriendTabContent called, redirecting to new version');
            window.initializeTellFriendTabContentNew();
        };
        
        // Automatically initialize on page load
        initializeSimplifiedTellFriendTab();
        
        // Test calling our functions
        console.log('Testing function calls:');
        console.log('1. Calling original function that should redirect:');
        window.initializeTellFriendTabContent();
        
        console.log('2. Calling new function directly:');
        window.initializeTellFriendTabContentNew();
    });
    </script>
</body>
</html>